<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário com Assinatura</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .signature-box {
            border: 1px solid #000;
            width: 100%;
            height: 150px;
            touch-action: none;
            display: block;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <form action="https://formspree.io/f/xvgoakqv" method="POST">
        <h1>Formulário com Assinatura</h1>
        <label>Nome: <input type="text" name="nome"></label><br>
        <label>Data: <input type="date" name="data"></label><br>
        
        <h2>Assinatura:</h2>
        <canvas class="signature-box"></canvas>
        <input type="hidden" name="assinatura" id="assinatura-hidden">
        
        <button type="button" id="clear-signature">Limpar Assinatura</button>
        <button type="submit" onclick="saveSignature()">Enviar</button>
    </form>

    <script>
        const signatureBox = document.querySelector('.signature-box');
        const ctx = signatureBox.getContext('2d');
        const hiddenInput = document.getElementById('assinatura-hidden');
        let isDrawing = false;

        // Redimensiona o canvas
        function resizeCanvas() {
            signatureBox.width = signatureBox.offsetWidth;
            signatureBox.height = signatureBox.offsetHeight;
            ctx.lineWidth = 2;
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Funções de desenho
        function startDrawing(event) {
            isDrawing = true;
            ctx.beginPath();
            ctx.moveTo(getX(event), getY(event));
            event.preventDefault();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function draw(event) {
            if (!isDrawing) return;
            ctx.lineTo(getX(event), getY(event));
            ctx.stroke();
            event.preventDefault();
        }

        function getX(event) {
            const rect = signatureBox.getBoundingClientRect();
            return (event.touches ? event.touches[0].clientX : event.clientX) - rect.left;
        }

        function getY(event) {
            const rect = signatureBox.getBoundingClientRect();
            return (event.touches ? event.touches[0].clientY : event.clientY) - rect.top;
        }

        signatureBox.addEventListener('mousedown', startDrawing);
        signatureBox.addEventListener('mouseup', stopDrawing);
        signatureBox.addEventListener('mousemove', draw);
        signatureBox.addEventListener('touchstart', startDrawing);
        signatureBox.addEventListener('touchend', stopDrawing);
        signatureBox.addEventListener('touchmove', draw);

        // Limpar assinatura
        document.getElementById('clear-signature').addEventListener('click', () => {
            ctx.clearRect(0, 0, signatureBox.width, signatureBox.height);
        });

        // Salvar assinatura no campo oculto
        function saveSignature() {
            const dataURL = signatureBox.toDataURL('image/png');
            hiddenInput.value = dataURL; // Armazena a imagem Base64 no campo oculto
        }
    </script>
</body>
</html>
